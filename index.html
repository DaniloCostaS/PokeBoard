<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokÃ©Board V21 - Full RPG</title>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
</head>
<body>

    <div id="setup-screen">
        <h1 class="title-highlight">PokÃ©Board V21</h1>
        <p class="subtitle">Tactics Edition</p>
        
        <div id="menu-phase-1">
            <button class="btn" onclick="window.Setup.showOfflineSetup()">ğŸ  JOGAR OFFLINE</button>
            <button class="btn" style="background:#8e44ad;" onclick="window.Setup.showOnlineMenu()">ğŸŒ JOGAR ONLINE</button>
            <div style="margin-top:15px; border-top:1px solid #eee; padding-top:10px;">
                <p style="font-size:0.8rem; color:#777;">Gerenciamento de Save</p>
                <button class="btn btn-secondary" onclick="window.Game.exportSave()">ğŸ’¾ Baixar Save (.txt)</button>
                <button class="btn btn-secondary" onclick="document.getElementById('file-input').click()">ğŸ“‚ Carregar Save (.txt)</button>
                <input type="file" id="file-input" style="display:none" onchange="window.Game.importSave(this)">
            </div>
        </div>

        <div id="menu-phase-online" style="display:none;">
            <h3>Modo Online</h3>
            <div class="setup-group">
                <label>Seu Nome (Para identificaÃ§Ã£o):</label>
                <input type="text" id="online-player-name" placeholder="Ex: Ash Ketchum" style="width:90%; padding:10px; font-weight:bold;">
            </div>
            <div id="online-lobby-controls">
                <button class="btn" onclick="window.Network.createRoom()">Criar Sala (Host)</button>
                <div style="display:flex; gap:5px; margin-top:10px;">
                    <input type="text" id="room-code-input" placeholder="CÃ³digo da Sala" style="flex:1; padding:10px;">
                    <button class="btn" style="width:auto; margin:0;" onclick="window.Network.joinRoom()">Entrar</button>
                </div>
            </div>
            <div id="lobby-status"></div>
            <button class="btn btn-secondary" onclick="location.reload()">Voltar</button>
        </div>

        <div id="menu-phase-setup" style="display:none;">
            <div class="setup-group">
                <label>NÃºmero de Jogadores:</label>
                <select id="num-players" onchange="window.Setup.updateSlots()">
                    <option value="2">2 Jogadores</option>
                    <option value="3">3 Jogadores</option>
                    <option value="4">4 Jogadores</option>
                    <option value="5">5 Jogadores</option>
                    <option value="6">6 Jogadores</option>
                    <option value="7">7 Jogadores</option>
                    <option value="8">8 Jogadores</option>
                </select>
            </div>
            <div class="setup-group">
                <label>Tamanho do Mapa:</label>
                <select id="map-size">
                    <option value="10">Pequeno (10x10)</option>
                    <option value="20" selected>MÃ©dio (20x20)</option>
                    <option value="30">Grande (30x30)</option>
                </select>
            </div>
            <div id="player-slots-container"></div>
            <button id="btn-start-game" class="btn" onclick="window.Setup.start()">ğŸš€ INICIAR JORNADA</button>
        </div>
    </div> 

    <div id="game-container">
        <div id="left-panel">
            <div class="panel-box turn-section">
                <small>TURNO ATUAL</small>
                <h2 id="turn-indicator">-</h2>
            </div>
            <div class="panel-box dice-section">
                <div id="d20-display">ğŸ² 20</div>
                <button id="roll-btn" class="btn btn-roll" onclick="window.Game.rollDice()">ROLAR</button>
            </div>
            <div class="panel-box extra-space">
                <small id="online-indicator" style="color:cyan;">OFFLINE</small>
            </div>
        </div>
        <div id="center-stage">
            <div id="hud-col-left" class="hud-column"></div>
            <div id="board-wrapper"><div id="board-area"></div></div>
            <div id="hud-col-right" class="hud-column"></div>
        </div>
        <div id="right-panel">
            <div class="panel-header">ğŸ“Ÿ Log de Batalha</div>
            <div id="log-container"></div>
        </div>
    </div>

    <div id="city-modal" class="modal-overlay">
        <div class="modal-box">
            <h2 style="color: #3498db;">ğŸ™ï¸ Centro PokÃ©mon</h2>
            <p>O que deseja fazer?</p>
            <div style="display:flex; gap:10px; justify-content:center; margin-top:20px;">
                <button class="btn" style="background:#2ecc71;" onclick="window.Game.handleCityChoice('heal')">â¤ï¸ Curar</button>
                <button class="btn btn-shop" onclick="window.Game.handleCityChoice('shop')">ğŸ›’ Loja</button>
            </div>
        </div>
    </div>

    <div id="shop-modal" class="modal-overlay">
        <div class="modal-box">
            <h2 class="text-highlight">ğŸ›’ PokÃ©Mart</h2>
            <p>Saldo: <span id="shop-gold" class="gold-text">0</span> G</p>
            <div id="shop-items-list" class="scroll-list"></div>
            <br><button class="btn btn-secondary" onclick="window.Shop.close()">Fechar</button>
        </div>
    </div>

    <div id="board-inventory-modal" class="modal-overlay">
        <div class="modal-box">
            <h3>ğŸ’ Mochila</h3>
            <div id="board-inventory-list" class="scroll-list"></div>
            <button class="btn btn-secondary mt-15" onclick="document.getElementById('board-inventory-modal').style.display='none'">Fechar</button>
        </div>
    </div>

    <div id="board-cards-modal" class="modal-overlay">
        <div class="modal-box">
            <h3>ğŸƒ Minhas Cartas</h3>
            <div id="board-cards-list" class="scroll-list"></div>
            <button class="btn btn-secondary mt-15" onclick="document.getElementById('board-cards-modal').style.display='none'">Fechar</button>
        </div>
    </div>

    <div id="pkmn-select-modal" class="modal-overlay z-high">
        <div class="modal-box"><h3 id="select-title">Escolha</h3><div id="pkmn-select-list" class="scroll-list text-left"></div></div>
    </div>

    <div id="battle-modal" class="modal-overlay">
        <div class="modal-box battle-box">
            <h2 id="battle-title">âš”ï¸ Batalha!</h2>
            <div class="battle-scene">
                <div class="battler self-end">
                    <div class="battle-info-box"><span id="ply-name">VocÃª</span> <span id="ply-lvl"></span></div>
                    <div class="battler-images">
                        <img id="ply-trainer-img" class="trainer-battle-img" src="">
                        <img id="ply-img" class="pokemon-battle-img" src="">
                    </div>
                    <div class="hp-container"><div id="ply-hp" class="hp-fill"></div></div>
                    <small id="ply-hp-text" style="text-shadow: 1px 1px 0 #000;">100/100</small>
                    <div id="ply-team-indicator" class="battle-team-indicator"></div>
                </div>

                <div class="battler self-start">
                    <div class="battle-info-box"><span id="opp-name">Rival</span> <span id="opp-lvl"></span></div>
                    <div class="battler-images">
                        <img id="opp-trainer-img" class="trainer-battle-img" src="">
                        <img id="opp-img" class="pokemon-battle-img" src="">
                    </div>
                    <div class="hp-container"><div id="opp-hp" class="hp-fill"></div></div>
                    <small id="opp-hp-text" style="text-shadow: 1px 1px 0 #000;">100/100</small>
                    <div id="opp-team-indicator" class="battle-team-indicator"></div>
                </div>
            </div>
            
            <div id="battle-msg">...</div>
            
            <div class="battle-actions">
                <button class="btn btn-attack" onclick="window.Battle.attack()">âš”ï¸ Atacar</button>
                <button class="btn btn-items" onclick="window.Battle.openBag()">ğŸ’ Itens</button>
                <button class="btn btn-cards" onclick="window.Battle.useCard()">ğŸƒ Cartas</button>
                <button id="btn-run" class="btn btn-run" onclick="window.Battle.run()">ğŸƒ Fugir</button>
            </div>

            <div id="battle-bag" style="display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(44, 62, 80, 0.95); z-index:20; padding:20px; box-sizing:border-box; border-radius:10px;">
                <h3>Usar Item (Batalha)</h3>
                <div id="battle-bag-list" class="scroll-list"></div>
                <button class="btn btn-secondary mt-15" onclick="document.getElementById('battle-bag').style.display='none'">Cancelar</button>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
</body>
</html>